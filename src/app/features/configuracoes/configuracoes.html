<div class="config-container">
  <!-- Header -->
  <div class="config-header">
    <h1 class="config-title">Configurações</h1>
    <p class="config-subtitle">Gerencie as configurações do sistema</p>
  </div>

  <!-- Main Tabs -->
  <div class="caring-card tabs">
    <div class="tab-list">
      <button 
        class="tab-trigger" 
        [class.active]="activeTab === 'geral'"
        (click)="setActiveTab('geral')">
        Geral
      </button>
      <button 
        class="tab-trigger" 
        [class.active]="activeTab === 'usuarios'"
        (click)="setActiveTab('usuarios')">
        Usuários
      </button>
      <button 
        class="tab-trigger" 
        [class.active]="activeTab === 'sistema'"
        (click)="setActiveTab('sistema')">
        Sistema
      </button>
    </div>

    <!-- Geral Tab Content -->
    <div class="tab-content" *ngIf="activeTab === 'geral'">
      <div class="sub-tabs">
        <div class="sub-tab-list">
          <button 
            class="sub-tab-trigger" 
            [class.active]="activeSubTab === 'identidade'"
            (click)="setActiveSubTab('identidade')">
            Identidade Visual
          </button>
          <button 
            class="sub-tab-trigger" 
            [class.active]="activeSubTab === 'email'"
            (click)="setActiveSubTab('email')">
            Configurações de E-mail
          </button>
          <button 
            class="sub-tab-trigger" 
            [class.active]="activeSubTab === 'gerais'"
            (click)="setActiveSubTab('gerais')">
            Configurações Gerais
          </button>
          <button 
            class="sub-tab-trigger" 
            [class.active]="activeSubTab === 'preferencias'"
            (click)="setActiveSubTab('preferencias')">
            Preferências do Sistema
          </button>
        </div>

        <!-- Identidade Visual -->
        <div class="sub-tab-content" *ngIf="activeSubTab === 'identidade'">
          <ui-card class="caring-card">
            <ui-card-header class="caring-card-header">
              <ui-card-title>Identidade Visual</ui-card-title>
              <p class="text-muted">Gerencie a logo da sua empresa no sistema</p>
            </ui-card-header>
            <ui-card-content class="caring-card-content identity-content">
              <div class="current-logo" *ngIf="logoUrl">
                <img [src]="logoUrl" alt="Logo atual" class="logo-preview">
                <div class="logo-info">
                  <span class="logo-label">Logo atual</span>
                  <p class="logo-description">Esta logo será exibida em todas as telas do sistema</p>
                </div>
              </div>
              
              <div class="form-group">
                <label for="logo">Selecionar nova logo</label>
                <p class="form-hint">Formatos aceitos: PNG, JPG, JPEG, GIF, SVG (máximo 5MB)</p>
                <input 
                  id="logo" 
                  type="file" 
                  accept="image/png,image/jpeg,image/jpg,image/gif,image/svg+xml"
                  (change)="onLogoFileSelected($event)"
                  class="file-input">
              </div>
              
              <div class="action-buttons">
                <ui-button 
                  [disabled]="!logoFile || uploading"
                  (click)="handleLogoUpload()"
                  class="btn-primary upload-btn"
                  *ngIf="logoFile">
                  <i class="icon-upload"></i>
                  {{uploading ? 'Salvando...' : 'Salvar Logo'}}
                </ui-button>
                
                <ui-button 
                  *ngIf="logoUrl && logoUrl !== 'assinatura-caring.png'"
                  variant="outline"
                  (click)="resetLogo()"
                  class="btn-secondary reset-btn"
                  [disabled]="uploading">
                  <i class="icon-refresh"></i>
                  Restaurar Logo Padrão
                </ui-button>
              </div>

              <div class="upload-info">
                <div class="info-item">
                  <i class="icon-info"></i>
                  <span>A logo será redimensionada automaticamente para se adequar ao design do sistema</span>
                </div>
                <div class="info-item">
                  <i class="icon-warning"></i>
                  <span>Recomendamos logos em formato horizontal para melhor visualização</span>
                </div>
              </div>
            </ui-card-content>
          </ui-card>
        </div>

        <!-- Email Configuration -->
        <div class="sub-tab-content" *ngIf="activeSubTab === 'email'">
          <ui-card class="caring-card">
            <ui-card-header class="caring-card-header">
              <ui-card-title>Configurações de E-mail</ui-card-title>
            </ui-card-header>
            <ui-card-content class="caring-card-content email-config">
              <div class="form-group">
                <label for="smtp-host">Servidor SMTP</label>
                <ui-input 
                  id="smtp-host"
                  [(ngModel)]="emailConfig.host"
                  placeholder="smtp.exemplo.com">
                </ui-input>
              </div>
              
              <div class="form-row">
                <div class="form-group">
                  <label for="smtp-port">Porta</label>
                  <ui-input 
                    id="smtp-port"
                    type="number"
                    [(ngModel)]="emailConfig.port"
                    placeholder="587">
                  </ui-input>
                </div>
                <div class="form-group">
                  <label for="smtp-security">Segurança</label>
                  <select [(ngModel)]="emailConfig.security" class="select-input">
                    <option value="tls">TLS</option>
                    <option value="ssl">SSL</option>
                    <option value="none">Nenhuma</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="smtp-user">Usuário</label>
                <ui-input 
                  id="smtp-user"
                  type="email"
                  [(ngModel)]="emailConfig.user"
                  placeholder="usuario@exemplo.com">
                </ui-input>
              </div>

              <div class="form-group">
                <label for="smtp-password">Senha</label>
                <ui-input 
                  id="smtp-password"
                  type="password"
                  [(ngModel)]="emailConfig.password"
                  placeholder="********">
                </ui-input>
              </div>

              <ui-button (click)="salvarConfiguracoes()" class="btn-primary save-btn">
                Salvar Configurações de E-mail
              </ui-button>
              
              <!-- Email Test Section -->
              <div class="email-test-section">
                <div class="test-header">
                  <i class="icon-mail"></i>
                  <span>Teste de E-mail</span>
                </div>
                <div class="form-group">
                  <label for="email-teste">E-mail para Teste</label>
                  <ui-input 
                    id="email-teste"
                    type="email"
                    [(ngModel)]="emailTeste"
                    placeholder="teste@exemplo.com">
                  </ui-input>
                </div>
                <ui-button 
                  variant="outline"
                  [disabled]="enviandoTeste || !emailTeste.trim()"
                  (click)="enviarEmailTeste()"
                  class="btn-secondary test-btn">
                  <i class="icon-send"></i>
                  {{enviandoTeste ? 'Enviando...' : 'Enviar E-mail Teste'}}
                </ui-button>
              </div>
            </ui-card-content>
          </ui-card>
        </div>

        <!-- General Settings -->
        <div class="sub-tab-content" *ngIf="activeSubTab === 'gerais'">
          <ui-card>
            <ui-card-header>
              <ui-card-title>Configurações Gerais</ui-card-title>
            </ui-card-header>
            <ui-card-content class="general-config">
              <div class="form-group">
                <label for="company-name">Nome da Empresa</label>
                <ui-input 
                  id="company-name"
                  [(ngModel)]="companyInfo.name"
                  placeholder="Caring Saúde">
                </ui-input>
              </div>

              <div class="form-group">
                <label for="company-phone">Telefone</label>
                <ui-input 
                  id="company-phone"
                  [(ngModel)]="companyInfo.phone"
                  placeholder="(11) 99999-9999">
                </ui-input>
              </div>

              <div class="form-group">
                <label for="company-address">Endereço</label>
                <ui-input 
                  id="company-address"
                  [(ngModel)]="companyInfo.address"
                  placeholder="Rua Exemplo, 123">
                </ui-input>
              </div>

              <ui-button (click)="salvarInformacoes()" class="btn-primary save-btn">
                Salvar Informações
              </ui-button>
            </ui-card-content>
          </ui-card>
        </div>

        <!-- System Preferences -->
        <div class="sub-tab-content" *ngIf="activeSubTab === 'preferencias'">
          <ui-card class="caring-card">
            <ui-card-header>
              <ui-card-title>Preferências do Sistema</ui-card-title>
            </ui-card-header>
            <ui-card-content class="preferences-config">
              <div class="form-group">
                <label for="timezone">Fuso Horário</label>
                <select [(ngModel)]="preferences.timezone" class="select-input">
                  <option value="America/Sao_Paulo">Brasília (UTC-3)</option>
                  <option value="America/Manaus">Manaus (UTC-4)</option>
                  <option value="America/Rio_Branco">Rio Branco (UTC-5)</option>
                </select>
              </div>

              <div class="form-group">
                <label for="date-format">Formato de Data</label>
                <select [(ngModel)]="preferences.dateFormat" class="select-input">
                  <option value="dd/mm/yyyy">DD/MM/AAAA</option>
                  <option value="mm/dd/yyyy">MM/DD/AAAA</option>
                  <option value="yyyy-mm-dd">AAAA-MM-DD</option>
                </select>
              </div>

              <div class="form-group">
                <label for="language">Idioma</label>
                <select [(ngModel)]="preferences.language" class="select-input">
                  <option value="pt-BR">Português (Brasil)</option>
                  <option value="en-US">English (US)</option>
                  <option value="es-ES">Español</option>
                </select>
              </div>

              <ui-button (click)="salvarPreferencias()" class="save-btn">
                Salvar Preferências
              </ui-button>
            </ui-card-content>
          </ui-card>
        </div>
      </div>
    </div>

    <!-- Users Tab Content -->
    <div class="tab-content" *ngIf="activeTab === 'usuarios'">
      <ui-card>
        <ui-card-header>
          <ui-card-title>Gerenciamento de Usuários</ui-card-title>
        </ui-card-header>
        <ui-card-content>
          <p>Funcionalidade de gerenciamento de usuários será implementada aqui.</p>
        </ui-card-content>
      </ui-card>
    </div>

    <!-- System Tab Content -->
    <div class="tab-content" *ngIf="activeTab === 'sistema'">
      <ui-card>
        <ui-card-header>
          <ui-card-title>Informações do Sistema</ui-card-title>
        </ui-card-header>
        <ui-card-content class="system-info">
          <div class="info-item">
            <strong>Versão:</strong> 1.0.0
          </div>
          <div class="info-item">
            <strong>Sistema:</strong> Gestão Caring
          </div>
          <div class="info-item">
            <strong>Última atualização:</strong> {{getCurrentDate()}}
          </div>
        </ui-card-content>
      </ui-card>
    </div>
  </div>
</div>